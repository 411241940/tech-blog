<!DOCTYPE html>
<html lang="zh-CN">
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ä¸Šä¸‹æ–‡æ£€ç´¢å¢å¼ºç”ŸæˆæŒ‡å— | æŠ€æœ¯åšå®¢</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;line-height:1.8;color:#333;background:#f8f9fa}
.container{max-width:900px;margin:0 auto;padding:20px}
header{background:linear-gradient(135deg,#11998e,#38ef7d);color:white;padding:60px 20px;text-align:center}
header h1{font-size:2.5em;margin-bottom:10px}
header p{opacity:0.9}
nav{background:white;padding:15px 20px;box-shadow:0 2px 10px rgba(0,0,0,0.1);position:sticky;top:0;z-index:100}
nav a{margin-right:25px;text-decoration:none;color:#11998e;font-weight:600}
nav a:hover{color:#38ef7d}
article{background:white;margin:30px 0;padding:40px;border-radius:12px;box-shadow:0 4px 20px rgba(0,0,0,0.08)}
article h1{color:#11998e;margin-bottom:25px;padding-bottom:15px;border-bottom:3px solid #11998e}
article h2{color:#38ef7d;margin:35px 0 15px}
article h3{color:#444;margin:25px 0 10px}
article p{margin:15px 0}
article a{color:#11998e;text-decoration:none}
article a:hover{text-decoration:underline}
article code{background:#f4f4f4;padding:3px 8px;border-radius:4px;font-family:monospace}
article pre{background:#2d3748;color:#f8f8f2;padding:20px;border-radius:8px;overflow-x:auto;margin:20px 0}
article pre code{background:none;color:inherit;padding:0}
article ul,article ol{margin:15px 0 15px 30px}
article li{margin:8px 0}
article blockquote{border-left:4px solid #11998e;padding:15px 20px;margin:20px 0;background:#f7f7fa;border-radius:0 8px 8px 0}
article table{width:100%;border-collapse:collapse;margin:20px 0}
article th,article td{border:1px solid #e2e8f0;padding:12px;text-align:left}
article th{background:linear-gradient(135deg,#11998e,#38ef7d);color:white}
article tr:nth-child(even){background:#f7f7fa}
article tr:hover{background:#edf2f7}
article .mermaid{background:white;padding:20px;margin:20px 0;text-align:center}
footer{text-align:center;padding:40px;color:#718096;border-top:1px solid #e2e8f0;margin-top:40px}
@media(max-width:768px){.container{padding:10px}article{padding:20px}header{padding:40px 20px}nav a{display:block;margin:10px 0}}
</style>
<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script>mermaid.initialize({startOnLoad:true,theme:'default'});</script>
</head>
<body>
<header><h1>ğŸš€ ä¸ªäººæŠ€æœ¯åšå®¢</h1><p>AI Agents å®è·µä¸æ¢ç´¢</p></header>
<nav class="container"><a href="index.html">ğŸ  é¦–é¡µ</a><a href="building-effective-agents.html">ğŸ¤– Effective Agents</a><a href="effective-context-engineering.html">ğŸ“¦ Context Engineering</a><a href="contextual-retrieval.html">ğŸ” Contextual Retrieval</a></nav>
<main class="container"><article><h1>ä¸Šä¸‹æ–‡æ£€ç´¢å¢å¼ºç”ŸæˆæŒ‡å—</h1>

<blockquote>ä½œè€…ï¼šAnthropic Applied AI Team (Daniel Ford, Orowa Sikder, Gautam Mittal, Kenneth Lien)</blockquote>
<blockquote>é˜…è¯»æ—¶é—´ï¼š2026-02-07</blockquote>
<blockquote>ç¿»è¯‘ï¼šHinnBot</blockquote>

<hr/>

<h2>ä¸€ã€å¼•è¨€ï¼šä¼ ç»Ÿ RAG çš„ç—›ç‚¹</h2>

<p>è¦è®© AI æ¨¡å‹åœ¨ç‰¹å®šåœºæ™¯ä¸‹å‘æŒ¥ä½œç”¨ï¼Œé€šå¸¸éœ€è¦è®©å®ƒè®¿é—®èƒŒæ™¯çŸ¥è¯†ã€‚æ¯”å¦‚ï¼š</p>

<ul>
<li>å®¢æœèŠå¤©æœºå™¨äººéœ€è¦äº†è§£å…·ä½“ä¸šåŠ¡çŸ¥è¯†</li>
<li>æ³•å¾‹åˆ†ææœºå™¨äººéœ€è¦äº†è§£å¤§é‡å†å²æ¡ˆä¾‹</li>
</ul>

<p>å¼€å‘è€…é€šå¸¸ä½¿ç”¨ <strong>RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰</strong> æ¥å¢å¼º AI æ¨¡å‹çš„çŸ¥è¯†ã€‚RAG çš„å·¥ä½œåŸç†æ˜¯ï¼šä»çŸ¥è¯†åº“ä¸­æ£€ç´¢ç›¸å…³ä¿¡æ¯ï¼Œå¹¶å°†å…¶é™„åŠ åˆ°ç”¨æˆ·æç¤ºä¸­ï¼Œä»è€Œæ˜¾è‘—æå‡æ¨¡å‹çš„å›ç­”è´¨é‡ã€‚</p>

<p><strong>ä½†æ˜¯ï¼Œä¼ ç»Ÿ RAG æœ‰ä¸€ä¸ªè‡´å‘½é—®é¢˜ï¼š</strong> åœ¨ç¼–ç ä¿¡æ¯æ—¶ä¼šä¸¢å¤±ä¸Šä¸‹æ–‡ï¼Œå¯¼è‡´ç³»ç»Ÿæ— æ³•ä»çŸ¥è¯†åº“ä¸­æ£€ç´¢åˆ°ç›¸å…³ä¿¡æ¯ã€‚</p>

<div class="mermaid">
graph TD
    subgraph "ä¼ ç»Ÿ RAG çš„é—®é¢˜"
        Q[ç”¨æˆ·æŸ¥è¯¢] -->|"æ£€ç´¢"| DB[(å‘é‡æ•°æ®åº“)]
        DB -->|"å¯èƒ½å¤±è´¥ âŒ"| Fail["ä¸¢å¤±ä¸Šä¸‹æ–‡<br/>æ£€ç´¢å¤±è´¥"]
        
        subgraph "ç¤ºä¾‹"
            Ex1["æŸ¥è¯¢ï¼šACME Corp Q2 2023 è¥æ”¶å¢é•¿ï¼Ÿ"]
            Ex2["æ£€ç´¢åˆ°ï¼šå…¬å¸è¥æ”¶å¢é•¿3"]
            Ex2 -.-> Problem["ä¸çŸ¥é“æ˜¯å“ªå®¶å…¬å¸<br/>å“ªä¸ªæ—¶é—´æ®µ"]
        end
    end
end

style Fail fill:#dc3545,stroke:#333,stroke-width:2px,color:#fff
</div>

<hr/>

<h2>äºŒã€Contextual Retrieval ç®€ä»‹</h2>

<p><strong>Contextual Retrieval</strong>ï¼ˆä¸Šä¸‹æ–‡æ£€ç´¢ï¼‰é€šè¿‡ä¸¤ä¸ªå­æŠ€æœ¯æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p>

<ul>
<li><strong>Contextual Embeddings</strong>ï¼ˆä¸Šä¸‹æ–‡åµŒå…¥ï¼‰</li>
<li><strong>Contextual BM25</strong>ï¼ˆä¸Šä¸‹æ–‡ BM25ï¼‰</li>
</ul>

<h3>æ€§èƒ½æå‡</h3>

<table>
<tr><th>æ–¹æ¡ˆ</th><th>æ£€ç´¢å¤±è´¥ç‡</th><th>æ”¹è¿›</th></tr>
<tr><td>ä¼ ç»Ÿ RAG</td><td>5.7</td><td>åŸºå‡†</td></tr>
<tr><td>+ Contextual Embeddings</td><td>3.7%</td><td>âœ… å‡å°‘ 35%</td></tr>
<tr><td>+ Contextual BM25</td><td>2.9%</td><td>âœ… å‡å°‘ 49%</td></tr>
<tr><td>+ é‡æ’åºï¼ˆRerankingï¼‰</td><td>1.9%</td><td>âœ… å‡å°‘ 67%</td></tr>
</table>

<div class="mermaid">
graph TD
    subgraph "æ€§èƒ½å¯¹æ¯”"
        Base["ä¼ ç»Ÿ RAG<br/>5.7 ç™¾åˆ†æ¯”  å¤±è´¥ç‡"] -->|"+ Contextual Embeddings"| C1["3.7 ç™¾åˆ†æ¯” <br/>å‡å°‘ 35 ç™¾åˆ†æ¯” "]
        C1 -->|"+ Contextual BM25"| C2["2.9 ç™¾åˆ†æ¯” <br/>å‡å°‘ 49 ç™¾åˆ†æ¯” "]
        C2 -->|"+ Reranking"| C3["1.9 ç™¾åˆ†æ¯” <br/>å‡å°‘ 67 ç™¾åˆ†æ¯” "]
    end
    
    style Base fill:#dc3545,stroke:#333,stroke-width:2px,color:#fff
    style C1 fill:#ffc107,stroke:#333,stroke-width:2px,color:#333
    style C2 fill:#28a745,stroke:#333,stroke-width:2px,color:#fff
    style C3 fill:#11998e,stroke:#333,stroke-width:3px,color:#fff
</div>

<blockquote>
ğŸ’¡ <strong>æ ¸å¿ƒæ´å¯Ÿ</strong>ï¼šä»…ä»…ä¸ºæ¯ä¸ªæ–‡æœ¬å—æ·»åŠ è§£é‡Šæ€§ä¸Šä¸‹æ–‡ï¼Œå°±èƒ½æ˜¾è‘—æå‡æ£€ç´¢å‡†ç¡®æ€§ï¼
</blockquote>

<hr/>

<h2>ä¸‰ã€ä¼ ç»Ÿ RAG çš„å›°å¢ƒ</h2>

<h3>åˆ†å—æ—¶çš„ä¸Šä¸‹æ–‡ä¸¢å¤±</h3>

<p>åœ¨ä¼ ç»Ÿ RAG ä¸­ï¼Œæ–‡æ¡£é€šå¸¸è¢«æ‹†åˆ†æˆè¾ƒå°çš„æ–‡æœ¬å—ä»¥æé«˜æ£€ç´¢æ•ˆç‡ã€‚è™½ç„¶è¿™ç§æ–¹æ³•åœ¨å¾ˆå¤šåœºæ™¯ä¸‹æœ‰æ•ˆï¼Œä½†å½“å•ä¸ªå—ç¼ºä¹è¶³å¤Ÿä¸Šä¸‹æ–‡æ—¶ï¼Œå°±ä¼šå‡ºç°é—®é¢˜ã€‚</p>

<div class="mermaid">
graph TD
    subgraph "ä¼ ç»Ÿåˆ†å—é—®é¢˜"
        Doc[åŸå§‹æ–‡æ¡£<br/>SEC æ–‡ä»¶] -->|"æ‹†åˆ†"| Chunk1["ç¬¬1å—<br/>'å…¬å¸è¥æ”¶å¢é•¿3'"]
        Doc -->|"æ‹†åˆ†"| Chunk2["ç¬¬2å—<br/>å­£åº¦æ•°æ®..."]
        
        Problem1["âŒ ä¸çŸ¥é“å“ªä¸ªå…¬å¸"]
        Problem2["âŒ ä¸çŸ¥é“å“ªä¸ªå­£åº¦"]
        Problem3["âŒ ç¼ºå°‘å…³é”®èƒŒæ™¯"]
        
        Chunk1 -.-> Problem1
        Chunk2 -.-> Problem2
    end
    
    style Doc fill:#11998e,stroke:#333,stroke-width:2px,color:#fff
    style Chunk1 fill:#dc3545,stroke:#333,stroke-width:1px,color:#fff
    style Chunk2 fill:#dc3545,stroke:#333,stroke-width:1px,color:#fff
</div>

<p><strong>ç¤ºä¾‹åœºæ™¯</strong>ï¼š</p>
<p>å‡è®¾çŸ¥è¯†åº“ä¸­åŒ…å«è´¢åŠ¡ä¿¡æ¯ï¼ˆSEC æ–‡ä»¶ï¼‰ï¼Œç”¨æˆ·é—®ï¼š"ACME Corp åœ¨ 2023 å¹´ Q2 çš„è¥æ”¶å¢é•¿æ˜¯å¤šå°‘ï¼Ÿ"</p>

<p>æ£€ç´¢åˆ°çš„å—å¯èƒ½æ˜¯ï¼š"å…¬å¸è¥æ”¶æ¯”ä¸Šä¸€å­£åº¦å¢é•¿ 3%"</p>

<p><strong>é—®é¢˜</strong>ï¼šè¿™ä¸ªå—æ²¡æœ‰è¯´æ˜æ˜¯å“ªå®¶å…¬å¸ï¼Œä¹Ÿæ²¡æœ‰è¯´æ˜æ˜¯å“ªä¸ªå­£åº¦ï¼Œå¯¼è‡´æ— æ³•æä¾›å‡†ç¡®çš„ç­”æ¡ˆã€‚</p>

<hr/>

<h2>å››ã€Contextual Retrieval çš„è§£å†³æ–¹æ¡ˆ</h2>

<h3>æ ¸å¿ƒæ€æƒ³</h3>

<p>Contextual Retrieval é€šè¿‡åœ¨åµŒå…¥ï¼ˆ"Contextual Embeddings"ï¼‰å’Œåˆ›å»º BM25 ç´¢å¼•ï¼ˆ"Contextual BM25"ï¼‰<strong>ä¹‹å‰</strong>ï¼Œä¸ºæ¯ä¸ªå—æ·»åŠ ç‰¹å®šçš„è§£é‡Šæ€§ä¸Šä¸‹æ–‡æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>

<div class="mermaid">
graph TD
    subgraph "Contextual Retrieval æµç¨‹"
        Doc[åŸå§‹æ–‡æ¡£] -->|"åˆ†å—"| Chunks[å¤šä¸ªæ–‡æœ¬å—]
        
        subgraph "æ·»åŠ ä¸Šä¸‹æ–‡"
            ContextPrompt["ä½¿ç”¨ Claude ç”Ÿæˆä¸Šä¸‹æ–‡"]
            Chunks -->|"+ æ–‡æ¡£ä¿¡æ¯"| ContextPrompt
            ContextPrompt -->|"æ·»åŠ è§£é‡Šæ€§ä¸Šä¸‹æ–‡"| ContextChunks["å¸¦ä¸Šä¸‹æ–‡çš„å—"]
        end
        
        subgraph "åŒé‡ç´¢å¼•"
            ContextChunks -->|"1. åµŒå…¥"| Embeddings[(ä¸Šä¸‹æ–‡åµŒå…¥)]
            ContextChunks -->|"2. BM25"| BM25Index[ä¸Šä¸‹æ–‡ BM25 ç´¢å¼•]
        end
        
        subgraph "æ£€ç´¢"
            Query[ç”¨æˆ·æŸ¥è¯¢] -->|"å¹¶è¡Œæ£€ç´¢"| Embeddings
            Query --> BM25Index
            Embeddings -->|"èåˆç»“æœ"| Results[Top-K ç›¸å…³å—]
            BM25Index --> Results
        end
        
        style ContextChunks fill:#11998e,stroke:#333,stroke-width:2px,color:#fff
        style Embeddings fill:#28a745,stroke:#333,stroke-width:1px,color:#fff
        style BM25Index fill:#28a745,stroke:#333,stroke-width:1px,color:#fff
    end
</div>

<h3>åˆ†å—è½¬æ¢ç¤ºä¾‹</h3>

<p><strong>åŸå§‹å—</strong>ï¼š</p>
<pre><code>"The company's revenue grew by 3 over the previous quarter."</code></pre>

<p><strong>æ·»åŠ ä¸Šä¸‹æ–‡å</strong>ï¼š</p>
<pre><code>"This chunk is from an SEC filing on ACME corp's performance in Q2 2023; 
the previous quarter's revenue was $314 million. The company's revenue grew 
by 3% over the previous quarter."</code></pre>

<p><strong>å·®å¼‚</strong>ï¼š</p>
<ul>
<li>âœ… æ˜ç¡®äº†å…¬å¸åç§°ï¼ˆACME Corpï¼‰</li>
<li>âœ… æ˜ç¡®äº†æ—¶é—´æ®µï¼ˆQ2 2023ï¼‰</li>
<li>âœ… æ·»åŠ äº†å…³é”®æ•°æ®ï¼ˆ$314 millionï¼‰</li>
</ul>

<hr/>

<h2>äº”ã€å®ç°æ–¹æ³•</h2>

<h3>ä½¿ç”¨ Claude ç”Ÿæˆä¸Šä¸‹æ–‡</h3>

<p>æ‰‹åŠ¨æ ‡æ³¨æ•°åƒç”šè‡³æ•°ç™¾ä¸‡ä¸ªå—æ˜¯ä¸ç°å®çš„ã€‚å€ŸåŠ© Claudeï¼Œæˆ‘ä»¬å¯ä»¥è‡ªåŠ¨ç”Ÿæˆç®€æ´çš„ã€å—ç‰¹å®šçš„ä¸Šä¸‹æ–‡ã€‚</p>

<p><strong>ä¸Šä¸‹æ–‡ç”Ÿæˆæç¤ºè¯</strong>ï¼š</p>

<pre><code class="language-text">&lt;document&gt;
{{WHOLE_DOCUMENT}}
&lt;/document&gt;

Here is the chunk we want to situate within the whole document:
&lt;chunk&gt;
{{CHUNK_CONTENT}}
&lt;/chunk&gt;

Please give a short succinct context to situate this chunk within the overall 
document for the purposes of improving search retrieval of the chunk. Answer 
only with the succinct context and nothing else.</code></pre>

<p><strong>ç”Ÿæˆç»“æœ</strong>ï¼šé€šå¸¸ 50-100 tokensï¼Œæ·»åŠ åˆ°æ¯ä¸ªå—çš„å¼€å¤´ã€‚</p>

<h3>é¢„å¤„ç†çš„å®Œæ•´æµç¨‹</h3>

<div class="mermaid">
graph TD
    subgraph "é¢„å¤„ç†æµç¨‹"
        Step1["1. æ–‡æ¡£åˆ†å—<br/>çº¦800 tokens/å—"] --> Step2["2. ç”Ÿæˆä¸Šä¸‹æ–‡<br/>ä½¿ç”¨ Claude 3 Haiku"]
        Step2 --> Step3["3. æ·»åŠ ä¸Šä¸‹æ–‡å‰ç¼€<br/>50-100 tokens"]
        Step3 --> Step4["4. åˆ›å»ºåŒé‡ç´¢å¼•<br/>Embeddings + BM25"]
        Step4 --> Ready[âœ… å‡†å¤‡å°±ç»ª]
    end
    
    subgraph "æˆæœ¬ä¼°ç®—"
        Cost["å‡è®¾ï¼š800 tokens/å—<br/>8k tokens/æ–‡æ¡£<br/>100 tokens ä¸Šä¸‹æ–‡<br/>æ¯ç™¾ä¸‡æ–‡æ¡£ tokens: $1.02"]
        Ready -.-> Cost
    end
end

style Step1 fill:#007bff,stroke:#333,stroke-width:1px,color:#fff
style Step2 fill:#11998e,stroke:#333,stroke-width:2px,color:#fff
style Step3 fill:#11998e,stroke:#333,stroke-width:2px,color:#fff
style Step4 fill:#28a745,stroke:#333,stroke-width:2px,color:#fff
style Ready fill:#38ef7d,stroke:#333,stroke-width:3px,color:#333
</div>

<blockquote>
ğŸ’¡ <strong>æˆæœ¬ä¼˜åŠ¿</strong>ï¼šå€ŸåŠ© Prompt Cachingï¼Œç”Ÿæˆä¸Šä¸‹æ–‡å—çš„æˆæœ¬ä»…ä¸º $1.02/ç™¾ä¸‡æ–‡æ¡£ tokensï¼Œæ¯”æƒ³è±¡ä¸­ä¾¿å®œå¾—å¤šï¼
</blockquote>

<hr/>

<h2>å…­ã€ç»“åˆé‡æ’åºè¿›ä¸€æ­¥ä¼˜åŒ–</h2>

<h3>ä»€ä¹ˆæ˜¯é‡æ’åºï¼Ÿ</h3>

<p>åœ¨ä¼ ç»Ÿ RAG ä¸­ï¼ŒAI ç³»ç»Ÿä¼šæœç´¢çŸ¥è¯†åº“ä»¥æ‰¾åˆ°å¯èƒ½ç›¸å…³çš„ä¿¡æ¯å—ã€‚å¯¹äºå¤§å‹çŸ¥è¯†åº“ï¼Œåˆå§‹æ£€ç´¢å¯èƒ½è¿”å›æ•°ç™¾ä¸ªç›¸å…³æ€§å„å¼‚çš„å—ã€‚</p>

<p><strong>é‡æ’åºï¼ˆRerankingï¼‰</strong> æ˜¯ä¸€ç§è¿‡æ»¤æŠ€æœ¯ï¼Œç¡®ä¿åªæœ‰æœ€ç›¸å…³çš„å—ä¼ é€’ç»™æ¨¡å‹ã€‚</p>

<div class="mermaid">
graph TD
    subgraph "é‡æ’åºæµç¨‹"
        Query[ç”¨æˆ·æŸ¥è¯¢] -->|"åˆæ­¥æ£€ç´¢"| Stage1["150 ä¸ªå€™é€‰å—"]
        
        Stage1 -->|"å‘é€åˆ° reranker"| Reranker((é‡æ’åºæ¨¡å‹<br/>Cohere/Voyage))
        
        Reranker -->|"ç›¸å…³æ€§è¯„åˆ†"| Stage2["Top-20 ç²¾é€‰å—"]
        Stage2 -->|"ä¼ é€’ç»™æ¨¡å‹"| Response[ç”Ÿæˆå›ç­”]
    end
    
    subgraph "æ•ˆæœ"
        Before["é‡æ’åºå‰ï¼š5.7 å¤±è´¥ç‡"]
        After["é‡æ’åºåï¼š1.9 ç™¾åˆ†æ¯”  å¤±è´¥ç‡"]
        Before -.-> After
    end
    
    style Stage1 fill:#ffc107,stroke:#333,stroke-width:1px,color:#333
    style Stage2 fill:#28a745,stroke:#333,stroke-width:2px,color:#fff
    style Reranker fill:#11998e,stroke:#333,stroke-width:2px,color:#fff
</div>

<h3>æ€§èƒ½å åŠ æ•ˆæœ</h3>

<table>
<tr><th>é…ç½®</th><th>å¤±è´¥ç‡</th><th>ç›¸å¯¹æ”¹è¿›</th></tr>
<tr><td>åŸºç¡€ Embeddings</td><td>5.7%</td><td>â€”</td></tr>
<tr><td>+ Contextual Retrieval</td><td>2.9%</td><td>+49%</td></tr>
<tr><td>+ Reranking</td><td>1.9%</td><td>+67%</td></tr>
</table>

<blockquote>
ğŸ¯ <strong>æœ€ä½³å®è·µ</strong>ï¼šContextual Embeddings + Contextual BM25 + Reranking = æœ€é«˜æ£€ç´¢å‡†ç¡®æ€§
</blockquote>

<hr/>

<h2>ä¸ƒã€å®æˆ˜å»ºè®®</h2>

<h3>1. Chunk è¾¹ç•Œé€‰æ‹©</h3>

<p>è€ƒè™‘å¦‚ä½•å°†æ–‡æ¡£æ‹†åˆ†æˆå—ã€‚å—å¤§å°ã€å—è¾¹ç•Œå’Œå—é‡å éƒ½ä¼šå½±å“æ£€ç´¢æ€§èƒ½ã€‚</p>

<div class="mermaid">
graph TD
    subgraph "Chunk ç­–ç•¥"
        TooSmall["âŒ å—å¤ªå°<br/>ä¸¢å¤±ä¸Šä¸‹æ–‡"]
        JustRight["âœ… é€‚ä¸­<br/>çº¦800 tokens"]
        TooLarge["âŒ å—å¤ªå¤§<br/>æ£€ç´¢ç²¾åº¦ä¸‹é™"]
        
        JustRight -.-> Overlap["æ·»åŠ é‡å "]
    end
end

<h3>2. Embedding æ¨¡å‹é€‰æ‹©</h3>

<table>
<tr><th>æ¨¡å‹</th><th>æ•ˆæœ</th><th>å¤‡æ³¨</th></tr>
<tr><td>Gemini Text 004</td><td>â­â­â­â­â­</td><td>æœ€ä½³è¡¨ç°</td></tr>
<tr><td>Voyage</td><td>â­â­â­â­â­</td><td>éå¸¸æœ‰æ•ˆ</td></tr>
<tr><td>å…¶ä»–æ¨¡å‹</td><td>â­â­â­</td><td>ä¹Ÿæœ‰æå‡</td></tr>
</table>

<blockquote>
ğŸ’¡ <strong>å‘ç°</strong>ï¼šContextual Retrieval åœ¨æ‰€æœ‰æµ‹è¯•çš„åµŒå…¥æ¨¡å‹ä¸Šéƒ½æœ‰æå‡ï¼Œä½† Gemini å’Œ Voyage å—ç›Šæœ€å¤§ã€‚
</blockquote>

<h3>3. è‡ªå®šä¹‰ä¸Šä¸‹æ–‡æç¤ºè¯</h3>

<p>è™½ç„¶é€šç”¨æç¤ºè¯æ•ˆæœä¸é”™ï¼Œä½†å¯¹äºç‰¹å®šé¢†åŸŸï¼Œä½¿ç”¨å®šåˆ¶æç¤ºè¯å¯èƒ½æ•ˆæœæ›´å¥½ï¼š</p>

<ul>
<li>åŒ…å«ä»…åœ¨å…¶ä»–æ–‡æ¡£ä¸­å®šä¹‰çš„ä¸“ä¸šæœ¯è¯­è¯æ±‡è¡¨</li>
<li>é’ˆå¯¹ç‰¹å®šè¡Œä¸šçš„èƒŒæ™¯ä¿¡æ¯</li>
<li>é¢†åŸŸç‰¹å®šçš„æ£€ç´¢çº¿ç´¢</li>
</ul>

<h3>4. Chunk æ•°é‡é€‰æ‹©</h3>

<table>
<tr><th>Top-K æ•°é‡</th><th>æ•ˆæœ</th><th>å»ºè®®</th></tr>
<tr><td>5</td><td>å¯èƒ½é—æ¼</td><td>âŒ ä¸æ¨è</td></tr>
<tr><td>10</td><td>ä¸€èˆ¬</td><td>âš ï¸ è§†æƒ…å†µ</td></tr>
<tr><td>20</td><td>æœ€ä½³</td><td>âœ… æ¨è</td></tr>
</table>

<blockquote>
ğŸ’¡ <strong>æç¤º</strong>ï¼šä¼ é€’æ›´å¤šå—ä¼šå¢åŠ åŒ…å«ç›¸å…³ä¿¡æ¯çš„æœºä¼šï¼Œä½†ä¿¡æ¯è¿‡å¤šä¼šè®©æ¨¡å‹åˆ†å¿ƒï¼Œéœ€è¦æƒè¡¡ã€‚
</blockquote>

<h3>5. å§‹ç»ˆè¿è¡Œè¯„ä¼°</h3>

<p>å“åº”ç”Ÿæˆæ—¶ï¼Œå¯ä»¥å°†ä¸Šä¸‹æ–‡åŒ–çš„å—ä¼ é€’ç»™æ¨¡å‹ï¼Œå¹¶åŒºåˆ†å“ªäº›æ˜¯ä¸Šä¸‹æ–‡ã€å“ªäº›æ˜¯åŸå§‹å—å†…å®¹ã€‚</p>

<hr/>

<h2>å…«ã€ä¸ä¸Šä¸‹æ–‡å·¥ç¨‹çš„å…³ç³»</h2>

<p>Contextual Retrieval æ˜¯ <strong>ä¸Šä¸‹æ–‡å·¥ç¨‹</strong>ï¼ˆè§ <a href="effective-context-engineering.html">ä¸Šä¸‹æ–‡å·¥ç¨‹æŒ‡å—</a>ï¼‰çš„ä¸€ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†ã€‚</p>

<div class="mermaid">
graph TD
    subgraph "ä¸Šä¸‹æ–‡å·¥ç¨‹ä½“ç³»"
        CE["ğŸ“¦ ä¸Šä¸‹æ–‡å·¥ç¨‹"] -->|"åŒ…å«"| CR["ğŸ” Contextual Retrieval"]
        CE -->|"åŒ…å«"| Tools["ğŸ”§ å·¥å…·è®¾è®¡"]
        CE -->|"åŒ…å«"| Compaction["ğŸ“ å‹ç¼©ç­–ç•¥"]
        CE -->|"åŒ…å«"| Notes["ğŸ“’ ç¬”è®°ç³»ç»Ÿ"]
        CE -->|"åŒ…å«"| SubAgents["ğŸ¤– å­æ™ºèƒ½ä½“"]
    end
    
    subgraph "Contextual Retrieval ä½ç½®"
        CR -->|"å±äº"| Retrieval["ğŸ“Š æ£€ç´¢å±‚é¢"]
    end
    
    style CE fill:#6f42c1,stroke:#333,stroke-width:3px,color:#fff
    style CR fill:#11998e,stroke:#333,stroke-width:2px,color:#fff
</div>

<h3>æ ¸å¿ƒåŸåˆ™ä¸€è‡´æ€§</h3>

<ul>
<li><strong>æœ€å°é«˜ä¿¡å· token é›†</strong>ï¼šContextual Retrieval é€šè¿‡æ·»åŠ ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œæé«˜æ¯ä¸ªæ£€ç´¢å—çš„ä¿¡æ¯å¯†åº¦</li>
<li><strong>é¿å…ä¸Šä¸‹æ–‡è…çƒ‚</strong>ï¼šç²¾ç¡®çš„ä¸Šä¸‹æ–‡ä¿¡æ¯æ¯”å¤§é‡æ¨¡ç³Šä¿¡æ¯æ›´æœ‰æ•ˆ</li>
<li><strong>åˆ†å±‚ä¿¡æ¯æ¶æ„</strong>ï¼šä¸Šä¸‹æ–‡ä¿¡æ¯ â†’ æ ¸å¿ƒå†…å®¹ â†’ è¾…åŠ©ä¿¡æ¯</li>
</ul>

<hr/>

<h2>ä¹ã€æ›¿ä»£æ–¹æ¡ˆå¯¹æ¯”</h2>

<h3>å…¶ä»–å°è¯•è¿‡çš„æ–¹æ³•ï¼ˆæ•ˆæœä¸ä½³ï¼‰</h3>

<table>
<tr><th>æ–¹æ³•</th><th>æ•ˆæœ</th><th>ç»“è®º</th></tr>
<tr><td>é€šç”¨æ–‡æ¡£æ‘˜è¦</td><td>âŒ æå‡æœ‰é™</td><td>ä¸å¤Ÿå…·ä½“</td></tr>
<tr><td>å‡è®¾æ–‡æ¡£åµŒå…¥ï¼ˆHyDEï¼‰</td><td>âš ï¸ æ•ˆæœä¸€èˆ¬</td><td>ä¸å¦‚çœŸå®ä¸Šä¸‹æ–‡</td></tr>
<tr><td>åŸºäºæ‘˜è¦çš„ç´¢å¼•</td><td>âŒ æ€§èƒ½è¾ƒä½</td><td>ä¸¢å¤±ç»†èŠ‚</td></tr>
<tr><td><strong>Contextual Retrieval</strong></td><td>âœ… <strong>æœ€ä½³</strong></td><td>æ˜¾è‘—æå‡</td></tr>
</table>

<blockquote>
ğŸ’¡ <strong>ç»“è®º</strong>ï¼šä¸ºæ¯ä¸ªå—æ·»åŠ çœŸå®çš„è§£é‡Šæ€§ä¸Šä¸‹æ–‡ï¼Œæ¯”å‡è®¾æˆ–æ‘˜è¦æ–¹æ³•æ›´æœ‰æ•ˆã€‚
</blockquote>

<hr/>

<h2>åã€æ€»ç»“</h2>

<h3>å…³é”®å‘ç°</h3>

<div class="mermaid">
graph TD
    subgraph "æœ€ä½³å®è·µç»„åˆ"
        Best["ğŸ† æœ€ä¼˜é…ç½®"] --> E["Voyage/Gemini åµŒå…¥"]
        Best --> B["Contextual BM25"]
        Best --> C["ä¸Šä¸‹æ–‡åµŒå…¥"]
        Best --> R["é‡æ’åº"]
        Best --> K["Top-20 æ£€ç´¢"]
        
        E --> Result["âœ… 67 æ£€ç´¢å¤±è´¥ç‡é™ä½"]
        B --> Result
        C --> Result
        R --> Result
        K --> Result
    end
    
    style Best fill:#11998e,stroke:#333,stroke-width:3px,color:#fff
    style Result fill:#38ef7d,stroke:#333,stroke-width:2px,color:#333
</div>

<h3>å®è·µå»ºè®®</h3>

<ol>
<li><strong>ä»ç®€å•å¼€å§‹</strong>ï¼šå¦‚æœçŸ¥è¯†åº“å°äº 200,000 tokensï¼Œç›´æ¥æŠŠæ•´ä¸ªçŸ¥è¯†åº“æ”¾è¿› prompt</li>
<li><strong>ä½¿ç”¨ Prompt Caching</strong>ï¼šå€ŸåŠ© Claude çš„ prompt cachingï¼Œå¤§å¹…é™ä½ Contextual Retrieval çš„æˆæœ¬</li>
<li><strong>ç»„åˆä½¿ç”¨</strong>ï¼šContextual Embeddings + Contextual BM25 + Reranking = æœ€ä½³æ•ˆæœ</li>
<li><strong>æŒç»­è¯„ä¼°</strong>ï¼šæ ¹æ®å®é™…æ•ˆæœè°ƒæ•´ chunk å¤§å°ã€top-k æ•°é‡ç­‰å‚æ•°</li>
</ol>

<h3>ç›¸å…³èµ„æº</h3>

<ul>
<li><a href="https://platform.claude.com/cookbook/capabilities-contextual-embeddings-guide" target="_blank">Anthropic Contextual Embeddings Cookbook</a></li>
<li><a href="https://platform.claude.com/cookbook/misc-prompt-caching" target="_blank">Prompt Caching Cookbook</a></li>
<li><a href="https://cohere.com/rerank" target="_blank">Cohere Reranker</a></li>
<li><a href="https://docs.voyageai.com/docs/reranker" target="_blank">Voyage Reranker</a></li>
<li><a href="https://ai.google.dev/gemini-api/docs/embeddings" target="_blank">Gemini Embeddings</a></li>
<li><a href="https://www.anthropic.com/engineering/effective-context-engineering-for-ai-agents" target="_blank">ä¸Šä¸‹æ–‡å·¥ç¨‹æŒ‡å—</a></li>
</ul>

<hr/>

<p><em>æ–‡æ¡£ç”Ÿæˆæ—¶é—´ï¼š2026-02-07</em></p>
<p><em>åŸæ–‡é“¾æ¥ï¼šhttps://www.anthropic.com/engineering/contextual-retrieval</em></p>
</article></main>
<footer><p>ğŸ“… æœ€åæ›´æ–°: 2026-02-07</p><p>Built with â¤ï¸</p></footer>
</body>
</html>
